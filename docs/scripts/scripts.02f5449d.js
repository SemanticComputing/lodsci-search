!function(){"use strict";angular.module("facetApp",["ui.router","seco.facetedSearch","ngTable","angular.filter","ngAnimate","ui.bootstrap"]).constant("_",_).constant("RESULTS_PER_PAGE",25).constant("PAGES_PER_QUERY",1).config(["$urlMatcherFactoryProvider",function(a){a.strictMode(!1)}]).config(["$urlRouterProvider",function(a){a.otherwise("/")}]).config(["$stateProvider",function(a){a.state("table",{url:"/",templateUrl:"views/lodsci.table.html",controller:"TableController",controllerAs:"vm"})}])}(),function(){"use strict";function a(a,b,c,d){function e(a){return r.getResults(a,i())}function f(){var b=angular.copy(l);return a.when(b)}function g(){return p}function h(a){var c=b.search().sortBy||"?id";c===a&&b.search("desc",b.search().desc?null:!0),b.search("sortBy",a)}function i(){var a=b.search().sortBy;c.isString(a)||(a=k);var d;return d=b.search().desc?"DESC("+a+")":a,a===k?d:d+" "+k}function j(a,c){var d=b.search().sortBy||k,e=c?"glyphicon-sort-by-order":"glyphicon-sort-by-alphabet";return d===a?b.search().desc?e+"-alt":e:void 0}var k="?id";this.getResults=e,this.getFacets=f,this.getFacetOptions=g,this.updateSortBy=h,this.getSortClass=j;var l={text:{facetId:"text",predicate:"<http://purl.org/dc/terms/description>",name:"Haku",enabled:!0},subject:{facetId:"subject",predicate:"<http://purl.org/dc/terms/subject>",name:"Subject",enabled:!0},rightsHolder:{facetId:"rightsHolder",predicate:"<http://purl.org/dc/terms/rightsHolder>",name:"Rights Holder",enabled:!0},creator:{facetId:"creator",predicate:"<http://purl.org/dc/terms/creator>",name:"Creator",enabled:!0},publisher:{facetId:"publisher",predicate:"<http://purl.org/dc/terms/publisher>",name:"Publisher",enabled:!0},license:{facetId:"license",predicate:"<http://purl.org/dc/terms/license>",name:"License",enabled:!0}},m=" PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> ",n=' SELECT DISTINCT * WHERE {  {     <RESULT_SET>   }   OPTIONAL { ?id dct:title ?title . FILTER(lang(?title) = "en") }  OPTIONAL { ?id dct:title ?title . FILTER(lang(?title) = "fi") }  OPTIONAL { ?id dct:title ?title . }  OPTIONAL { ?id dct:description ?description . }  OPTIONAL { ?id dct:license ?license . }  OPTIONAL { ?id dct:creator ?creator . FILTER(lang(?creator) = "en") }  OPTIONAL { ?id dct:creator ?creator . FILTER(lang(?creator) = "fi") }  OPTIONAL { ?id dct:creator ?creator . }  OPTIONAL { ?id dct:subject ?subject . }  OPTIONAL { ?id dct:rightsHolder ?rightsHolder . }  OPTIONAL { ?id dct:publisher ?publisher . }  }',o="https://ldf.fi/service-descriptions/sparql",p={endpointUrl:o,rdfClass:"<http://www.w3.org/ns/sparql-service-description#Dataset>",constraint:'  OPTIONAL { ?id <http://purl.org/dc/terms/title> ?title . FILTER(lang(?title) = "en") }  OPTIONAL { ?id <http://purl.org/dc/terms/title> ?title . FILTER(lang(?title) = "fi") }  OPTIONAL { ?id <http://purl.org/dc/terms/title> ?title . }',preferredLang:"fi"},q={queryTemplate:n,prefixes:m,pagesPerQuery:2},r=new d(o,q)}angular.module("facetApp").service("lodsciService",a),a.$inject=["$q","$location","_","FacetResultHandler"]}(),function(){"use strict";function a(a,b,c){function d(c,d){return a("navbar-fi.html").then(function(b){return d.html(b),a("views/subnavbar.html")}).then(function(a){return angular.element("#subnav").html(a),b(d.contents())(c)})}function e(){function a(){c.open({templateUrl:"views/help.html",size:"lg"})}var b=this;b.showHelp=a}return{link:d,controller:e,controllerAs:"vm"}}angular.module("facetApp").directive("wsNavbar",a),a.$inject=["$templateRequest","$compile","$uibModal"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(a){return d.castArray(a)}function k(){b.reload()}function l(){s.tableParams=new g({count:e},{getData:o})}function m(a){c.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return a}}})}function n(){var a=f.getFacetOptions();return a.initialState=i.getFacetValuesFromUrlParams(),a}function o(a){return s.isLoadingResults=!0,s.pager.getPage(a.page()-1,a.count()).then(function(a){return s.pager.getTotalCount().then(function(b){return s.tableParams.total(b),a}).then(function(a){return s.isLoadingResults=!1,a})})}function p(a,b){return i.updateUrlParams(b),s.previousSelections=d.clone(b.constraint),q(b)}function q(a){s.isLoadingResults=!0,f.getResults(a).then(function(a){s.pager=a,s.tableParams?(s.tableParams.page(1),s.tableParams.reload()):l()})}function r(a){return f.updateSortBy(a),q({constraint:s.previousSelections})}var s=this;s.openPage=m,s.toArray=j,s.removeFacetSelections=k,s.sortBy=r,s.getSortClass=f.getSortClass;var t=a.$on("sf-initial-constraints",function(a,b){p(a,b),t()});a.$on("sf-facet-constraints",p),f.getFacets().then(function(b){s.facets=b,s.facetOptions=n(),s.facetOptions.scope=a,s.handler=new h(s.facetOptions)})}angular.module("facetApp").controller("TableController",a),a.$inject=["$scope","$state","$uibModal","_","RESULTS_PER_PAGE","lodsciService","NgTableParams","FacetHandler","facetUrlStateHandlerService"]}(),angular.module("facetApp").run(["$templateCache",function(a){"use strict";a.put("views/help.html",'<div class="modal-header"> <div class="row"> <div class="col-xs-10 text-left"> <h3 class="modal-title">LODSCI Dataset Search</h3> </div> <div class="col-xs-2"> <a href="#" ng-click="$close()" class="no-decoration btn-lg pull-right glyphicon glyphicon-remove"></a> </div> </div> </div> <div class="modal-body"> </div>'),a.put("views/lodsci.description.partial.html","<h1>LODSCI Dataset Search</h1>"),a.put("views/lodsci.facets.partial.html",'<a href="" ng-click="vm.removeFacetSelections()">Remove all selections</a> <div class="facets"> <seco-text-facet data-options="vm.facets.text"></seco-text-facet> <div class="show-facets row"> <div class="col-xs-12"> <button class="btn btn-default pull-right visible-xs-block visible-sm-block" ng-click="show = !show">{{ show ? \'Piilota fasetit\' : \'Näytä fasetit\' }}</button> </div> </div> <div class="hideable-facets" ng-class="{ \'hidden-sm hidden-xs\': !show }"> <seco-basic-facet data-options="vm.facets.subject"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.rightsHolder"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.creator"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.publisher"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.license"></seco-basic-facet> </div> </div>'),a.put("views/lodsci.table.html",'<div class="container-fluid"> <div class="row"> <div class="col-xs-9 col-md-8 col-lg-9 vcenter push-xs-9"> <div ng-include="\'views/lodsci.description.partial.html\'"></div> </div> <div class="col-md-3 pull-md-3 col-lg-2"> <div ng-include="\'views/lodsci.facets.partial.html\'"></div> </div> <div class="col-md-9 col-lg-10"> Sort: <span class="sort"> <a href="" ng-click="vm.sortBy(\'?title\')">Title</a> <span ng-class="vm.getSortClass(\'?title\', true)" class="glyphicon" aria-hidden="true"></span> </span> <div ng-include="\'views/lodsci.table.partial.html\'"></div> </div> </div> </div>'),a.put("views/lodsci.table.partial.html",'<table class="table table-striped norssi-table ng-table-responsive" ng-table="vm.tableParams"> <thead> <tr> <th class="col-xs-2">Dataset</th> <th class="col-xs-4">Description</th> <th class="col-xs-3">Organization</th> <th class="col-xs-3">License</th> </tr> </thead> <tbody> <tr ng-show="!vm.isLoadingResults" ng-repeat="dataset in $data"> <td>{{ ::dataset.title }}</td> <td> {{ ::dataset.description }} <span ng-if="::dataset.subject"><br><b>Subject:</b> {{ ::vm.toArray(dataset.subject) | join: \', \' }}</span> </td> <td> <span ng-if="::dataset.rightsHolder"><b>Rights Holder:</b> {{ ::vm.toArray(dataset.rightsHolder) | join:\', \' }}<br></span> <span ng-if="::dataset.creator"><b>Creator:</b> {{ ::vm.toArray(dataset.creator) | join:\', \' }}<br></span> <span ng-if="::dataset.publisher"><b>Publisher:</b> {{ ::vm.toArray(dataset.publisher) | join:\', \' }}<br></span> </td> <td>{{ ::vm.toArray(dataset.license) | join:\', \' }}</td> </tr> </tbody> </table> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),a.put("views/page-modal.html",'<div class="modal-header"> <div class="row"> <div class="col-xs-8"> <h3 class="modal-title">{{ $ctrl.person.ordinal }} {{ $ctrl.person.givenName }} {{ $ctrl.person.familyName }}</h3> </div> <div class="col-xs-4 text-right"> <button class="btn btn-default" ng-click="$ctrl.previousPage()" ng-disabled="$ctrl.pageNo === 1" aria-label="Edellinen sivu"> <span class="glyphicon glyphicon-step-backward"></span> </button> <span>{{ $ctrl.pageNo }}</span> <button class="btn btn-default" ng-click="$ctrl.nextPage()" ng-disabled="$ctrl.pageNo === 716" aria-label="Seuraava sivu"> <span class="glyphicon glyphicon-step-forward"></span> </button> <button ng-click="$ctrl.close()" class="btn btn-default" aria-label="Sulje"> <span aria-hidden="true" class="glyphicon glyphicon-remove"></span> </button> </div> </div> </div><div class="modal-body"> <img class="img img-responsive" ng-src="{{ $ctrl.pageUrl }}"> </div>'),a.put("views/subnavbar.html",'<ul class="nav navbar-nav"> <li><a href="" id="show-help" ng-click="vm.showHelp()"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Help</a></li> </ul>')}]);